{% extends 'layout.html' %}
{% block css %}
{% endblock %}
{% block body %}
    <div class="panel-heading">
        <div class="row">
            <div id="info" class="col-md-12">
                <h4>Your Shifts</h4>
            </div>
        </div>
    </div>
    <div class="panel-body">
<div class="row">
    <div id="info" class="col-md-12">
        <h3>Your Shifts</h3>
    </div>
</div>
<div id="your_shifts" class="col-md-12">
<table id="shiftTable" class="shiftTable" border="1">
    {% for i in range(-1, 24) %}
        <tr>
            {% for j in range(-1, 7) %}
                {% if j == -1 and i >= 0 %}
                    <td>{{i}}:00</td>
                {% elif i == -1 and j > -1 %}
                    <td>{{days[j]}}</td>
                {% else %}
                    <td></td>
                {% endif %}
            {% endfor %}
        </tr>
    {% endfor %}
</table>
    <script>console.log("{{upcoming_shifts}}");</script>
{% for shift in upcoming_shifts %}
    {% set start_time = datetime.utcfromtimestamp(shift['adjusted_start']) %}
    {% set end_time = datetime.utcfromtimestamp(shift['adjusted_finish']) %}
    <script>
        table = document.getElementById("shiftTable");
        for (i = parseInt("{{start_time.hour}}"); i < parseInt("{{end_time.hour}}"); i++) {
            table.rows[i].cells["{{start_time.isoweekday()}}"].setAttribute("style", "background-color:green");
            table.rows[i].cells["{{start_time.isoweekday()}}"].onclick = function() {
                $.post("/shift/offer/" + "{{shift['id']}}", {}, function(response) {console.log("Successful:" + response)});
            }
        }
    </script>
{% endfor %}
</div>
</div>
</div>

{% endblock %}